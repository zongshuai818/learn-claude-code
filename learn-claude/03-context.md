═══════════════════════════════════════════════════════════════════
第 03 课：管理上下文
═══════════════════════════════════════════════════════════════════

## 什么是上下文？

上下文是 Claude 在对话中可以"看到"的所有内容 —— 你的消息、Claude 的回复、已读取的文件、已编写的代码。它们都存在于一个**上下文窗口**中，有大小限制。

把它想象成一块白板。当你工作时，你会填满它。当它满了时，旧内容会被擦除以腾出空间给新内容。如果重要的细节被擦除了，Claude 可能会忘记你已经讨论过的事情。

## 为什么它很重要

你正在进行深入的调试会话。你已经分享了堆栈跟踪、解释了架构、浏览了文件。然后 Claude 错过了你之前问过的事情。

发生了什么？对话太长了，早期上下文被挤出了。以下是如何管理它。

## 关键命令

**`/context`** — 显示你已使用的上下文窗口数量。

**`/compact`** — 将对话总结为关键点，释放空间同时保留重要上下文。

**`/clear`** — 清除对话历史并释放上下文。

## 试试看

是时候为地下城与智能体添加房间了。

1. 运行 `/context` 查看你已使用的上下文窗口数量。

2. 要求 Claude 扩展房间系统：

   > 扩展地下城游戏，添加更多房间。cave-entrance 已存在于 data/rooms.json 中。添加 4 个相连的房间：
   >
   > - "narrow-tunnel"（入口上方）— 狭窄的通道，出口：下、右、上、左
   > - "treasure-room"（隧道右侧）— 金光闪闪的房间，有金币，出口：左
   > - "underground-lake"（隧道左侧）— 巨大的洞穴，有黑暗的水域，出口：右、左
   > - "secret-garden"（隧道上方）— 地下绽放的奇异花朵，出口：下
   >
   > 更新 cave-entrance，添加向上的出口到 narrow-tunnel。
   > 更新 game.js，使 'look' 显示当前房间描述和出口，'go [方向]' 或方向键（ArrowUp/Down/Left/Right）在房间间移动。
   > 在 ui/ui.js 中更新 mapLayout 网格，以正确位置显示所有房间。
   > 确保地图和房间位置匹配。

3. 测试游戏：使用 `go up`、方向键、`look` 进行探索。

4. 再次运行 `/context` — 注意使用量增加了。

当你添加更多功能时：内容变长时使用 `/compact`，重新开始时使用 `/clear`。

完成后告诉我，或如果你有问题！
